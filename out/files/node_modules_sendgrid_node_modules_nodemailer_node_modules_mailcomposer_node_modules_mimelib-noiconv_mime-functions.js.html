<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>node_modules&#x2F;sendgrid&#x2F;node_modules&#x2F;nodemailer&#x2F;node_modules&#x2F;mailcomposer&#x2F;node_modules&#x2F;mimelib-noiconv&#x2F;mime-functions.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Enables filtering in class lists..html">Enables filtering in class lists.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings..html">Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised date and time strings..html">Namespace container for the JsWorld library objects..Class for parsing localised date and time strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised number strings..html">Namespace container for the JsWorld library objects..Class for parsing localised number strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;.html">Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: node_modules&#x2F;sendgrid&#x2F;node_modules&#x2F;nodemailer&#x2F;node_modules&#x2F;mailcomposer&#x2F;node_modules&#x2F;mimelib-noiconv&#x2F;mime-functions.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">

try{
    &#x2F;&#x2F; see http:&#x2F;&#x2F;github.com&#x2F;bnoordhuis&#x2F;node-iconv for more info
    var Iconv = require(&quot;iconv&quot;).Iconv;
}catch(E){
    &#x2F;&#x2F; convert nothing
    Iconv = function(){}
    Iconv.prototype.convert = function(buf){return buf;};
}

&#x2F;* mime related functions - encoding&#x2F;decoding etc*&#x2F;
&#x2F;* TODO: Only UTF-8 and Latin1 are allowed with encodeQuotedPrintable *&#x2F;
&#x2F;* TODO: Check if the input string even needs encoding                *&#x2F;

&#x2F;**
 * mime.foldLine(str, maxLength, foldAnywhere) -&gt; String
 * - str (String): mime string that might need folding
 * - maxLength (Number): max length for a line, defaults to 78
 * - foldAnywhere (Boolean): can fold at any location (ie. in base64)
 * - afterSpace (Boolean): If [true] fold after the space
 * 
 * Folds a long line according to the RFC 5322
 *   &lt;http:&#x2F;&#x2F;tools.ietf.org&#x2F;html&#x2F;rfc5322#section-2.1.1&gt;
 * 
 * For example:
 *     Content-Type: multipart&#x2F;alternative; boundary=&quot;----bd_n3-lunchhour1283962663300----&quot;
 * will become
 *     Content-Type: multipart&#x2F;alternative;
 *          boundary=&quot;----bd_n3-lunchhour1283962663300----&quot;
 * 
 **&#x2F;
this.foldLine = function(str, maxLength, foldAnywhere, afterSpace){
    var line=false, curpos=0, response=&quot;&quot;, lf;
    maxLength = maxLength || 78;
    
    &#x2F;&#x2F; return original if no need to fold
    if(str.length&lt;=maxLength)
        return str;
    
    &#x2F;&#x2F; read in &lt;maxLength&gt; bytes and try to fold it
    while(line = str.substr(curpos, maxLength)){
        if(!!foldAnywhere){
            response += line;
            if(curpos+maxLength&lt;str.length){
                response+=&quot;\r\n&quot;;
            }
        }else{
            lf = line.lastIndexOf(&quot; &quot;);
            if(lf&lt;=0)
                lf = line.lastIndexOf(&quot;\t&quot;);
            if(line.length&gt;=maxLength &amp;&amp; lf&gt;0){
                if(!!afterSpace){
                    &#x2F;&#x2F; move forward until line end or no more \s and \t
                    while(lf&lt;line.length &amp;&amp; (line.charAt(lf)==&quot; &quot; || line.charAt(lf)==&quot;\t&quot;)){
                        lf++;
                    }
                }
                response += line.substr(0,lf)+&quot;\r\n&quot;+(!foldAnywhere &amp;&amp; !afterSpace &amp;&amp; &quot;       &quot; || &quot;&quot;);
                curpos -= line.substr(lf).length;
            }else{
                response += line;
                &#x2F;&#x2F;line = line.replace(&#x2F;=[a-f0-9]?$&#x2F;i, &quot;&quot;);
                &#x2F;&#x2F;response+=line + &quot;\r\n&quot;;
            }
        }
        curpos += line.length;
    }
    
    &#x2F;&#x2F; return folded string
    return response;
}


&#x2F;**
 * mime.encodeMimeWord(str, encoding, charset) -&gt; String
 * - str (String): String to be encoded
 * - encoding (String): Encoding Q for quoted printable or B (def.) for base64
 * - charset (String): Charset to be used
 * 
 * Encodes a string into mime encoded word format
 *   &lt;http:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;MIME#Encoded-Word&gt;
 *
 * For example:
 *     See on õhin test
 * Becomes with UTF-8 and Quoted-printable encoding
 *     =?UTF-8?q?See_on_=C3=B5hin_test?=
 * 
 **&#x2F;
this.encodeMimeWord = function(str, encoding, charset){
    charset = charset || &quot;UTF-8&quot;;
    encoding = encoding &amp;&amp; encoding.toUpperCase() || &quot;B&quot;;
    
    if(encoding==&quot;Q&quot;){
        str = this.encodeQuotedPrintable(str, true, charset);
    }
    
    if(encoding==&quot;B&quot;){
        str = this.encodeBase64(str);
    }
    
    return &quot;=?&quot;+charset+&quot;?&quot;+encoding+&quot;?&quot;+str+&quot;?=&quot;;
}

&#x2F;**
 * mime.decodeMimeWord(str, encoding, charset) -&gt; String
 * - str (String): String to be encoded
 * - encoding (String): Encoding Q for quoted printable or B (def.) for base64
 * - charset (String): Charset to be used, defaults to UTF-8
 * 
 * Decodes a string from mime encoded word format, see [[encodeMimeWord]]
 * 
 **&#x2F;

this.decodeMimeWord = function(str){
    var parts = str.split(&quot;?&quot;),
        charset = parts &amp;&amp; parts[1],
        encoding = parts &amp;&amp; parts[2],
        text = parts &amp;&amp; parts[3];
    if(!charset || !encoding || !text)
        return str;
    if(encoding.toUpperCase()==&quot;Q&quot;){
        return this.decodeQuotedPrintable(text, true, charset);
    }
    
    if(encoding.toUpperCase()==&quot;B&quot;){
        return this.decodeBase64(text);
    }
    
    return text;
}


&#x2F;**
 * mime.encodeQuotedPrintable(str, mimeWord, charset) -&gt; String
 * - str (String): String to be encoded into Quoted-printable
 * - mimeWord (Boolean): Use mime-word mode (defaults to false)
 * - charset (String): Destination charset, defaults to UTF-8
 *   TODO: Currently only allowed charsets: UTF-8, LATIN1
 * 
 * Encodes a string into Quoted-printable format. 
 **&#x2F;
this.encodeQuotedPrintable = function(str, mimeWord, charset){
    charset = charset || &quot;UTF-8&quot;;
    
    &#x2F;*
     * Characters from 33-126 OK (except for =; and ?_ when in mime word mode)
     * Spaces + tabs OK (except for line beginnings and endings)  
     * \n + \r OK
     *&#x2F;
    
    str = str.replace(&#x2F;[^\sa-zA-Z\d]&#x2F;gm,function(c){
        if(!!mimeWord){
            if(c==&quot;?&quot;)return &quot;=3F&quot;;
            if(c==&quot;_&quot;)return &quot;=5F&quot;;
        }
        if(c!==&quot;=&quot; &amp;&amp; c.charCodeAt(0)&gt;=33 &amp;&amp; c.charCodeAt(0)&lt;=126)
            return c;
        return c==&quot;=&quot;?&quot;=3D&quot;:(charset==&quot;UTF-8&quot;?encodeURIComponent(c):escape(c)).replace(&#x2F;%&#x2F;g,&#x27;=&#x27;);
    });
    
    str = lineEdges(str);

    if(!mimeWord){
        &#x2F;&#x2F; lines might not be longer than 76 bytes, soft break: &quot;=\r\n&quot;
        var lines = str.split(&#x2F;\r?\n&#x2F;);
        str.replace(&#x2F;(.{73}(?!\r?\n))&#x2F;,&quot;$&amp;=\r\n&quot;)
        for(var i=0, len = lines.length; i&lt;len; i++){
            if(lines[i].length&gt;76){
                lines[i] = this.foldLine(lines[i],76, false, true).replace(&#x2F;\r\n&#x2F;g,&quot;=\r\n&quot;);
            }
        }
        str = lines.join(&quot;\r\n&quot;);
    }else{
        str = str.replace(&#x2F;\s&#x2F;g, function(a){
            if(a==&quot; &quot;)return &quot;_&quot;;
            if(a==&quot;\t&quot;)return &quot;=09&quot;;
            return a==&quot;\r&quot;?&quot;=0D&quot;:&quot;=0A&quot;;
        });
    }

    return str;
}

&#x2F;**
 * mime.deccodeQuotedPrintable(str, mimeWord, charset) -&gt; String
 * - str (String): String to be decoded
 * - mimeWord (Boolean): Use mime-word mode (defaults to false)
 * - charset (String): Charset to be used, defaults to UTF-8
 * 
 * Decodes a string from Quoted-printable format. 
 **&#x2F;
this.decodeQuotedPrintable = function(str, mimeWord, charset){
    charset = charset &amp;&amp; charset.toUpperCase() || &quot;UTF-8&quot;;

    if(mimeWord){
        str = str.replace(&#x2F;_&#x2F;g,&quot; &quot;);
    }else{
        str = str.replace(&#x2F;=\r\n&#x2F;gm,&#x27;&#x27;);
        str = str.replace(&#x2F;=$&#x2F;,&quot;&quot;);
    }
    if(charset == &quot;UTF-8&quot;)
        str = decodeURIComponent(str.replace(&#x2F;%&#x2F;g,&#x27;%25&#x27;).replace(&#x2F;=&#x2F;g,&quot;%&quot;));
    else{
        str = str.replace(&#x2F;%&#x2F;g,&#x27;%25&#x27;).replace(&#x2F;=&#x2F;g,&quot;%&quot;);
        if(charset==&quot;ISO-8859-1&quot; || charset==&quot;LATIN1&quot;)
            str = unescape(str);
        else{
            str = decodeBytestreamUrlencoding(str);
            str = fromCharset(charset, str);
        }
    }
    return str;
}

&#x2F;**
 * mime.encodeBase64(str) -&gt; String
 * - str (String): String to be encoded into Base64
 * - charset (String): Destination charset, defaults to UTF-8
 * 
 * Encodes a string into Base64 format. Base64 is mime-word safe. 
 **&#x2F;
this.encodeBase64 = function(str, charset){
    var buffer;
    if(charset &amp;&amp; charset.toUpperCase()!=&quot;UTF-8&quot;)
        buffer = toCharset(charset, str);
    else
        buffer = new Buffer(str, &quot;UTF-8&quot;);
    return buffer.toString(&quot;base64&quot;);
}

&#x2F;**
 * mime.decodeBase64(str) -&gt; String
 * - str (String): String to be decoded from Base64
 * - charset (String): Source charset, defaults to UTF-8
 * 
 * Decodes a string from Base64 format. Base64 is mime-word safe.
 * NB! Always returns UTF-8 
 **&#x2F;
this.decodeBase64 = function(str, charset){
    var buffer = new Buffer(str, &quot;base64&quot;);
    
    if(charset &amp;&amp; charset.toUpperCase()!=&quot;UTF-8&quot;){
        return fromCharset(charset, buffer);
    }
    
    &#x2F;&#x2F; defaults to utf-8
    return buffer.toString(&quot;UTF-8&quot;);
}

&#x2F;**
 * mime.parseHeaders(headers) -&gt; Array
 * - headers (String): header section of the e-mail
 * 
 * Parses header lines into an array of objects (see [[parseHeaderLine]])
 * FIXME: This should probably not be here but in &quot;envelope&quot; instead
 **&#x2F;
this.parseHeaders = function(headers){
    var text, lines, line, i, name, value, cmd, header_lines = {};
    &#x2F;&#x2F; unfold
    headers = headers.replace(&#x2F;\r?\n([ \t])&#x2F;gm,&quot; &quot;);

    &#x2F;&#x2F; split lines
    lines = headers.split(&#x2F;\r?\n&#x2F;);
    for(i=0; i&lt;lines.length;i++){
        if(!lines[i]) &#x2F;&#x2F; no more header lines
            break;
        cmd = lines[i].match(&#x2F;[^\:]+&#x2F;);
        if(cmd &amp;&amp; (cmd = cmd[0])){
            name = cmd;
            value = lines[i].substr(name.length+1);
            if(!header_lines[name.toLowerCase().trim()])header_lines[name.toLowerCase().trim()] = [];
            header_lines[name.toLowerCase()].push(value.trim());
        }
    }
    
    return header_lines;
}

&#x2F;**
 * mime.parseAddresses(addresses) -&gt; Array
 * - addresses (String): string with comma separated e-mail addresses
 * 
 * Parses names and addresses from a from, to, cc or bcc line
 **&#x2F;
this.parseAddresses = function(addresses){
    if(!addresses)
        return {};

    addresses = addresses.replace(&#x2F;\=\?[^?]+\?[QqBb]\?[^?]+\?=&#x2F;g, (function(a){return this.decodeMimeWord(a);}).bind(this));
    
    &#x2F;&#x2F; not sure if it&#x27;s even needed - urlencode escaped \\ and \&quot; and \&#x27;
    addresses = addresses.replace(&#x2F;\\\\&#x2F;g,function(a){return escape(a.charAt(1));});
    addresses = addresses.replace(&#x2F;\\[&quot;&#x27;]&#x2F;g,function(a){return escape(a.charAt(1));});
    
    &#x2F;&#x2F; find qutoed strings
    
    var parts = addresses.split(&#x27;,&#x27;), curStr,
        curQuote, lastPos, remainder=&quot;&quot;, str, list = [],
        curAddress, address, addressArr = [], name, email, i, len;
    var rightEnd;

    &#x2F;&#x2F; separate quoted text from text parts
    for(i=0, len=parts.length; i&lt;len; i++){
        str = &quot;&quot;;
    
        curStr = (remainder+parts[i]).trim();
        
        curQuote = curStr.charAt(0);
        if(curQuote == &quot;&#x27;&quot; || curQuote == &#x27;&quot;&#x27;){
            rightEnd= curStr.indexOf(&quot;&lt;&quot;);
            if(rightEnd == -1)rightEnd= curStr.length-1;
            lastPos = curStr.lastIndexOf(curQuote,rightEnd);
            
            if(!lastPos){
                remainder = remainder+parts[i]+&quot;,&quot;;
                continue;
            }else{
                remainder = &quot;&quot;;
                str = curStr.substring(1, lastPos).trim();
                address = curStr.substr(lastPos+1).trim();
            }
            
        }else{
            address = curStr;
        }
        
        list.push({name: str, address: address, original: curStr});
    }
  
    &#x2F;&#x2F; find e-mail addresses and user names
    for(i=0, len=list.length; i&lt;len; i++){
        curAddress = list[i];
        
        email = false;
        name = false;
        
        name = curAddress.name;
        
        address = curAddress.address.replace(&#x2F;&lt;([^&gt;]+)&gt;&#x2F;, function(original, addr){
            email = addr.indexOf(&quot;@&quot;)&gt;=0 &amp;&amp; addr;
            return email ? &quot;&quot; : original;
        }).trim();
        
        if(!email){
            address = address.replace(&#x2F;(\S+@\S+)&#x2F;, function(original, m){
                email = m;
                return email ? &quot;&quot; : original;
            });
        }
        
        if(!name){
            if(email){
                email = email.replace(&#x2F;\(([^)]+)\)&#x2F;,function(original, n){
                    name = n;
                    return &quot;&quot;;
                });
            }
            if(!name){
                name = address.replace(&#x2F;&quot;&#x2F;g,&quot;&quot;).trim();
            }
        }
        
        &#x2F;&#x2F; just in case something got mixed up
        if(!email &amp;&amp; name.indexOf(&quot;@&quot;)&gt;=0){
            email = name;
            name = false;
        }
        
        if(name || email){
            addressArr.push({address:decodeURIComponent(email || &quot;&quot;), name: decodeURIComponent(name || &quot;&quot;)});
        }
    }
    return addressArr;
};

&#x2F;**
 * mime.parseMimeWords(str) -&gt; String
 * - str (String): string to be parsed
 * 
 * Parses mime-words into UTF-8 strings
 **&#x2F;
this.parseMimeWords = function(str){
    return str.replace(&#x2F;=\?[^?]+\?[QqBb]\?[^?]+\?=&#x2F;g, (function(a){
        return this.decodeMimeWord(a);
    }).bind(this));
}

&#x2F;**
 * mime.parseHeaderLine(line) -&gt; Object
 * - line (String): a line from a message headers
 * 
 * Parses a header line to search for additional parameters.
 * For example with &quot;text&#x2F;plain; charset=utf-8&quot; the output would be
 *   - defaultValue = text&#x2F;plain
 *   - charset = utf-8
 **&#x2F;
this.parseHeaderLine = function(line){
    if(!line)
        return {};
    var result = {}, parts = line.split(&quot;;&quot;), pos;
    for(var i=0, len = parts.length; i&lt;len; i++){
        pos = parts[i].indexOf(&quot;=&quot;);
        if(pos&lt;0){
            result[!i?&quot;defaultValue&quot;:&quot;i-&quot;+i] = parts[i].trim();
        }else{
            result[parts[i].substr(0,pos).trim().toLowerCase()] = parts[i].substr(pos+1).trim();
        }
    }
    return result;
}


&#x2F;* Helper functions *&#x2F;

&#x2F;**
 * lineEdges(str) -&gt; String
 * - str (String): String to be processed
 * 
 * Replaces all spaces and tabs in the beginning and end of the string
 * with quoted printable encoded chars. Needed by [[encodeQuotedPrintable]]
 **&#x2F;
function lineEdges(str){
    str = str.replace(&#x2F;^[ \t]+&#x2F;gm, function(wsc){
        return wsc.replace(&#x2F; &#x2F;g,&quot;=20&quot;).replace(&#x2F;\t&#x2F;g,&quot;=09&quot;); 
    });
    
    str = str.replace(&#x2F;[ \t]+$&#x2F;gm, function(wsc){
        return wsc.replace(&#x2F; &#x2F;g,&quot;=20&quot;).replace(&#x2F;\t&#x2F;g,&quot;=09&quot;); 
    });
    return str;
}

&#x2F;**
 * fromCharset(charset, buffer, keep_buffer) -&gt; String | Buffer
 * - charset (String): Source charset
 * - buffer (Buffer): Buffer in &lt;charset&gt;
 * - keep_buffer (Boolean): If true, return buffer, otherwise UTF-8 string
 * 
 * Converts a buffer in &lt;charset&gt; codepage into UTF-8 string
 **&#x2F;
function fromCharset(charset, buffer, keep_buffer){
    var iconv = new Iconv(charset,&#x27;UTF-8&#x27;),
        buffer = iconv.convert(buffer);
    return keep_buffer?buffer:buffer.toString(&quot;utf-8&quot;);
}

&#x2F;**
 * toCharset(charset, buffer) -&gt; Buffer
 * - charset (String): Source charset
 * - buffer (Buffer): Buffer in UTF-8 or string
 * 
 * Converts a string or buffer to &lt;charset&gt; codepage
 **&#x2F;
function toCharset(charset, buffer){
    var iconv = new Iconv(&#x27;UTF-8&#x27;,charset);
    return iconv.convert(buffer);
}

&#x2F;**
 * decodeBytestreamUrlencoding(encoded_string) -&gt; Buffer
 * - encoded_string (String): String in urlencode coding
 * 
 * Converts an urlencoded string into a bytestream buffer. If the used
 * charset is known the resulting string can be converted to UTF-8 with
 * [[fromCharset]]. 
 * NB! For UTF-8 use decodeURIComponent and for Latin 1 decodeURL instead 
 **&#x2F;
function decodeBytestreamUrlencoding(encoded_string){
    var c, i, j=0, prcnts = encoded_string.match(&#x2F;%&#x2F;g) || &quot;&quot;,
            buffer_length = encoded_string.length - (prcnts.length*2),
        buffer = new Buffer(buffer_length);

    for(var i=0; i&lt;encoded_string.length; i++){
        c = encoded_string.charCodeAt(i);
        if(c==&quot;37&quot;){ &#x2F;&#x2F; %
            c = parseInt(encoded_string.substr(i+1,2), 16);
            i+=2;
        }
        buffer[j++] = c;
    }
    return buffer;
}


    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
