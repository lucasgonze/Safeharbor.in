<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>node_modules&#x2F;express&#x2F;node_modules&#x2F;connect&#x2F;lib&#x2F;middleware&#x2F;static.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Enables filtering in class lists..html">Enables filtering in class lists.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings..html">Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised date and time strings..html">Namespace container for the JsWorld library objects..Class for parsing localised date and time strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised number strings..html">Namespace container for the JsWorld library objects..Class for parsing localised number strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;.html">Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: node_modules&#x2F;express&#x2F;node_modules&#x2F;connect&#x2F;lib&#x2F;middleware&#x2F;static.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">

&#x2F;*!
 * Connect - staticProvider
 * Copyright(c) 2010 Sencha Inc.
 * Copyright(c) 2011 TJ Holowaychuk
 * MIT Licensed
 *&#x2F;

&#x2F;**
 * Module dependencies.
 *&#x2F;

var fs = require(&#x27;fs&#x27;)
  , path = require(&#x27;path&#x27;)
  , join = path.join
  , basename = path.basename
  , normalize = path.normalize
  , utils = require(&#x27;..&#x2F;utils&#x27;)
  , Buffer = require(&#x27;buffer&#x27;).Buffer
  , parse = require(&#x27;url&#x27;).parse
  , mime = require(&#x27;mime&#x27;);

&#x2F;**
 * Static file server with the given &#x60;root&#x60; path.
 *
 * Examples:
 *
 *     var oneDay = 86400000;
 *
 *     connect(
 *       connect.static(__dirname + &#x27;&#x2F;public&#x27;)
 *     ).listen(3000);
 *
 *     connect(
 *       connect.static(__dirname + &#x27;&#x2F;public&#x27;, { maxAge: oneDay })
 *     ).listen(3000);
 *
 * Options:
 *
 *    - &#x60;maxAge&#x60;   Browser cache maxAge in milliseconds. defaults to 0
 *    - &#x60;hidden&#x60;   Allow transfer of hidden files. defaults to false
 *    - &#x60;redirect&#x60;   Redirect to trailing &quot;&#x2F;&quot; when the pathname is a dir
 *
 * @param {String} root
 * @param {Object} options
 * @return {Function}
 * @api public
 *&#x2F;

exports = module.exports = function static(root, options){
  options = options || {};

  &#x2F;&#x2F; root required
  if (!root) throw new Error(&#x27;static() root path required&#x27;);
  options.root = root;

  return function static(req, res, next) {
    options.path = req.url;
    options.getOnly = true;
    send(req, res, next, options);
  };
};

&#x2F;**
 * Expose mime module.
 *&#x2F;

exports.mime = mime;

&#x2F;**
 * Respond with 416  &quot;Requested Range Not Satisfiable&quot;
 *
 * @param {ServerResponse} res
 * @api private
 *&#x2F;

function invalidRange(res) {
  var body = &#x27;Requested Range Not Satisfiable&#x27;;
  res.setHeader(&#x27;Content-Type&#x27;, &#x27;text&#x2F;plain&#x27;);
  res.setHeader(&#x27;Content-Length&#x27;, body.length);
  res.statusCode = 416;
  res.end(body);
}

&#x2F;**
 * Attempt to tranfer the requseted file to &#x60;res&#x60;.
 *
 * @param {ServerRequest}
 * @param {ServerResponse}
 * @param {Function} next
 * @param {Object} options
 * @api private
 *&#x2F;

var send = exports.send = function(req, res, next, options){
  options = options || {};
  if (!options.path) throw new Error(&#x27;path required&#x27;);

  &#x2F;&#x2F; setup
  var maxAge = options.maxAge || 0
    , ranges = req.headers.range
    , head = &#x27;HEAD&#x27; == req.method
    , get = &#x27;GET&#x27; == req.method
    , root = options.root ? normalize(options.root) : null
    , redirect = false === options.redirect ? false : true
    , getOnly = options.getOnly
    , fn = options.callback
    , hidden = options.hidden
    , done;

  &#x2F;&#x2F; replace next() with callback when available
  if (fn) next = fn;

  &#x2F;&#x2F; ignore non-GET requests
  if (getOnly &amp;&amp; !get &amp;&amp; !head) return next();

  &#x2F;&#x2F; parse url
  var url = parse(options.path)
    , path = decodeURIComponent(url.pathname)
    , type;

  &#x2F;&#x2F; null byte(s)
  if (~path.indexOf(&#x27;\0&#x27;)) return utils.badRequest(res);

  &#x2F;&#x2F; when root is not given, consider .. malicious
  if (!root &amp;&amp; ~path.indexOf(&#x27;..&#x27;)) return utils.forbidden(res);

  &#x2F;&#x2F; join &#x2F; normalize from optional root dir
  path = normalize(join(root, path));

  &#x2F;&#x2F; malicious path
  if (root &amp;&amp; 0 != path.indexOf(root)) return fn
    ? fn(new Error(&#x27;Forbidden&#x27;))
    : utils.forbidden(res);

  &#x2F;&#x2F; index.html support
  if (normalize(&#x27;&#x2F;&#x27;) == path[path.length - 1]) path += &#x27;index.html&#x27;;

  &#x2F;&#x2F; &quot;hidden&quot; file
  if (!hidden &amp;&amp; &#x27;.&#x27; == basename(path)[0]) return next();

  fs.stat(path, function(err, stat){
    &#x2F;&#x2F; mime type
    type = mime.lookup(path);

    &#x2F;&#x2F; ignore ENOENT
    if (err) {
      if (fn) return fn(err);
      return &#x27;ENOENT&#x27; == err.code
        ? next()
        : next(err);
    &#x2F;&#x2F; redirect directory in case index.html is present
    } else if (stat.isDirectory()) {
      if (!redirect) return next();
      res.statusCode = 301;
      res.setHeader(&#x27;Location&#x27;, url.pathname + &#x27;&#x2F;&#x27;);
      res.end(&#x27;Redirecting to &#x27; + url.pathname + &#x27;&#x2F;&#x27;);
      return;
    }

    &#x2F;&#x2F; header fields
    if (!res.getHeader(&#x27;Date&#x27;)) res.setHeader(&#x27;Date&#x27;, new Date().toUTCString());
    if (!res.getHeader(&#x27;Cache-Control&#x27;)) res.setHeader(&#x27;Cache-Control&#x27;, &#x27;public, max-age=&#x27; + (maxAge &#x2F; 1000));
    if (!res.getHeader(&#x27;Last-Modified&#x27;)) res.setHeader(&#x27;Last-Modified&#x27;, stat.mtime.toUTCString());
    if (!res.getHeader(&#x27;ETag&#x27;)) res.setHeader(&#x27;ETag&#x27;, utils.etag(stat));
    if (!res.getHeader(&#x27;content-type&#x27;)) {
      var charset = mime.charsets.lookup(type);
      res.setHeader(&#x27;Content-Type&#x27;, type + (charset ? &#x27;; charset=&#x27; + charset : &#x27;&#x27;));
    }
    res.setHeader(&#x27;Accept-Ranges&#x27;, &#x27;bytes&#x27;);

    &#x2F;&#x2F; conditional GET support
    if (utils.conditionalGET(req)) {
      if (!utils.modified(req, res)) {
        req.emit(&#x27;static&#x27;);
        return utils.notModified(res);
      }
    }

    var opts = {};
    var chunkSize = stat.size;

    &#x2F;&#x2F; we have a Range request
    if (ranges) {
      ranges = utils.parseRange(stat.size, ranges);
      &#x2F;&#x2F; valid
      if (ranges) {
        &#x2F;&#x2F; TODO: stream options
        &#x2F;&#x2F; TODO: multiple support
        opts.start = ranges[0].start;
        opts.end = ranges[0].end;
        chunkSize = opts.end - opts.start + 1;
        res.statusCode = 206;
        res.setHeader(&#x27;Content-Range&#x27;, &#x27;bytes &#x27;
          + opts.start
          + &#x27;-&#x27;
          + opts.end
          + &#x27;&#x2F;&#x27;
          + stat.size);
      &#x2F;&#x2F; invalid
      } else {
        return fn
          ? fn(new Error(&#x27;Requested Range Not Satisfiable&#x27;))
          : invalidRange(res);
      }
    }

    res.setHeader(&#x27;Content-Length&#x27;, chunkSize);

    &#x2F;&#x2F; transfer
    if (head) return res.end();

    &#x2F;&#x2F; stream
    var stream = fs.createReadStream(path, opts);
    req.emit(&#x27;static&#x27;, stream);
    stream.pipe(res);

    &#x2F;&#x2F; callback
    if (fn) {
      function callback(err) { done || fn(err); done = true }
      req.on(&#x27;close&#x27;, callback);
      stream.on(&#x27;end&#x27;, callback);
    }
  });
};

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
