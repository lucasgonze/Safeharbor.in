<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>node_modules&#x2F;express&#x2F;lib&#x2F;view.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Enables filtering in class lists..html">Enables filtering in class lists.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings..html">Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised date and time strings..html">Namespace container for the JsWorld library objects..Class for parsing localised date and time strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised number strings..html">Namespace container for the JsWorld library objects..Class for parsing localised number strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;.html">Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: node_modules&#x2F;express&#x2F;lib&#x2F;view.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">

&#x2F;*!
 * Express - view
 * Copyright(c) 2010 TJ Holowaychuk &lt;tj@vision-media.ca&gt;
 * MIT Licensed
 *&#x2F;

&#x2F;**
 * Module dependencies.
 *&#x2F;

var path = require(&#x27;path&#x27;)
  , extname = path.extname
  , dirname = path.dirname
  , basename = path.basename
  , utils = require(&#x27;connect&#x27;).utils
  , View = require(&#x27;.&#x2F;view&#x2F;view&#x27;)
  , partial = require(&#x27;.&#x2F;view&#x2F;partial&#x27;)
  , union = require(&#x27;.&#x2F;utils&#x27;).union
  , merge = utils.merge
  , http = require(&#x27;http&#x27;)
  , res = http.ServerResponse.prototype;

&#x2F;**
 * Expose constructors.
 *&#x2F;

exports = module.exports = View;

&#x2F;**
 * Export template engine registrar.
 *&#x2F;

exports.register = View.register;

&#x2F;**
 * Lookup and compile &#x60;view&#x60; with cache support by supplying
 * both the &#x60;cache&#x60; object and &#x60;cid&#x60; string,
 * followed by &#x60;options&#x60; passed to &#x60;exports.lookup()&#x60;.
 *
 * @param {String} view
 * @param {Object} cache
 * @param {Object} cid
 * @param {Object} options
 * @return {View}
 * @api private
 *&#x2F;

exports.compile = function(view, cache, cid, options){
  if (cache &amp;&amp; cid &amp;&amp; cache[cid]){
    options.filename = cache[cid].path;
    return cache[cid];
  }

  &#x2F;&#x2F; lookup
  view = exports.lookup(view, options);

  &#x2F;&#x2F; hints
  if (!view.exists) {
    if (options.hint) hintAtViewPaths(view.original, options);
    var err = new Error(&#x27;failed to locate view &quot;&#x27; + view.original.view + &#x27;&quot;&#x27;);
    err.view = view.original;
    throw err;
  }

  &#x2F;&#x2F; compile
  options.filename = view.path;
  view.fn = view.templateEngine.compile(view.contents, options);
  cache[cid] = view;

  return view;
};

&#x2F;**
 * Lookup &#x60;view&#x60;, returning an instanceof &#x60;View&#x60;.
 *
 * Options:
 *
 *   - &#x60;root&#x60; root directory path
 *   - &#x60;defaultEngine&#x60; default template engine
 *   - &#x60;parentView&#x60; parent &#x60;View&#x60; object
 *   - &#x60;cache&#x60; cache object
 *   - &#x60;cacheid&#x60; optional cache id
 *
 * Lookup:
 *
 *   - partial &#x60;_&lt;name&gt;&#x60;
 *   - any &#x60;&lt;name&gt;&#x2F;index&#x60;
 *   - non-layout &#x60;..&#x2F;&lt;name&gt;&#x2F;index&#x60;
 *   - any &#x60;&lt;root&gt;&#x2F;&lt;name&gt;&#x60;
 *   - partial &#x60;&lt;root&gt;&#x2F;_&lt;name&gt;&#x60;
 *
 * @param {String} view
 * @param {Object} options
 * @return {View}
 * @api private
 *&#x2F;

exports.lookup = function(view, options){
  var orig = view = new View(view, options)
    , partial = options.isPartial
    , layout = options.isLayout;

  &#x2F;&#x2F; Try _ prefix ex: .&#x2F;views&#x2F;_&lt;name&gt;.jade
  &#x2F;&#x2F; taking precedence over the direct path
  if (partial) {
    view = new View(orig.prefixPath, options);
    if (!view.exists) view = orig;
  }

  &#x2F;&#x2F; Try index ex: .&#x2F;views&#x2F;user&#x2F;index.jade
  if (!layout &amp;&amp; !view.exists) view = new View(orig.indexPath, options);

  &#x2F;&#x2F; Try ..&#x2F;&lt;name&gt;&#x2F;index ex: ..&#x2F;user&#x2F;index.jade
  &#x2F;&#x2F; when calling partial(&#x27;user&#x27;) within the same dir
  if (!layout &amp;&amp; !view.exists) view = new View(orig.upIndexPath, options);

  &#x2F;&#x2F; Try root ex: &lt;root&gt;&#x2F;user.jade
  if (!view.exists) view = new View(orig.rootPath, options);

  &#x2F;&#x2F; Try root _ prefix ex: &lt;root&gt;&#x2F;_user.jade
  if (!view.exists &amp;&amp; partial) view = new View(view.prefixPath, options);

  view.original = orig;
  return view;
};

&#x2F;**
 * Partial render helper.
 *
 * @api private
 *&#x2F;

function renderPartial(res, view, options, parentLocals, parent){
  var collection, object, locals;

  if (options) {
    &#x2F;&#x2F; collection
    if (options.collection) {
      collection = options.collection;
      delete options.collection;
    } else if (&#x27;length&#x27; in options) {
      collection = options;
      options = {};
    }

    &#x2F;&#x2F; locals
    if (options.locals) {
      locals = options.locals;
      delete options.locals;
    }

    &#x2F;&#x2F; object
    if (&#x27;Object&#x27; != options.constructor.name) {
      object = options;
      options = {};
    } else if (undefined != options.object) {
      object = options.object;
      delete options.object;
    }
  } else {
    options = {};
  }

  &#x2F;&#x2F; Inherit locals from parent
  union(options, parentLocals);

  &#x2F;&#x2F; Merge locals
  if (locals) merge(options, locals);

  &#x2F;&#x2F; Partials dont need layouts
  options.isPartial = true;
  options.layout = false;

  &#x2F;&#x2F; Deduce name from view path
  var name = options.as || partial.resolveObjectName(view);

  &#x2F;&#x2F; Render partial
  function render(){
    if (object) {
      if (&#x27;string&#x27; == typeof name) {
        options[name] = object;
      } else if (name === global) {
        merge(options, object);
      }
    }
    return res.render(view, options, null, parent, true);
  }

  &#x2F;&#x2F; Collection support
  if (collection) {
    var len = collection.length
      , buf = &#x27;&#x27;
      , keys
      , key
      , val;

    options.collectionLength = len;

    if (&#x27;number&#x27; == typeof len || Array.isArray(collection)) {
      for (var i = 0; i &lt; len; ++i) {
        val = collection[i];
        options.firstInCollection = i == 0;
        options.indexInCollection = i;
        options.lastInCollection = i == len - 1;
        object = val;
        buf += render();
      }
    } else {
      keys = Object.keys(collection);
      len = keys.length;
      options.collectionLength = len;
      options.collectionKeys = keys;
      for (var i = 0; i &lt; len; ++i) {
        key = keys[i];
        val = collection[key];
        options.keyInCollection = key;
        options.firstInCollection = i == 0;
        options.indexInCollection = i;
        options.lastInCollection = i == len - 1;
        object = val;
        buf += render();
      }
    }

    return buf;
  } else {
    return render();
  }
};

&#x2F;**
 * Render &#x60;view&#x60; partial with the given &#x60;options&#x60;. Optionally a
 * callback &#x60;fn(err, str)&#x60; may be passed instead of writing to
 * the socket.
 *
 * Options:
 *
 *   - &#x60;object&#x60; Single object with name derived from the view (unless &#x60;as&#x60; is present)
 *
 *   - &#x60;as&#x60; Variable name for each &#x60;collection&#x60; value, defaults to the view name.
 *     * as: &#x27;something&#x27; will add the &#x60;something&#x60; local variable
 *     * as: this will use the collection value as the template context
 *     * as: global will merge the collection value&#x27;s properties with &#x60;locals&#x60;
 *
 *   - &#x60;collection&#x60; Array of objects, the name is derived from the view name itself.
 *     For example _video.html_ will have a object _video_ available to it.
 *
 * @param  {String} view
 * @param  {Object|Array|Function} options, collection, callback, or object
 * @param  {Function} fn
 * @return {String}
 * @api public
 *&#x2F;

res.partial = function(view, options, fn){
  var app = this.app
    , options = options || {}
    , viewEngine = app.set(&#x27;view engine&#x27;)
    , parent = {};

  &#x2F;&#x2F; accept callback as second argument
  if (&#x27;function&#x27; == typeof options) {
    fn = options;
    options = {};
  }

  &#x2F;&#x2F; root &quot;views&quot; option
  parent.dirname = app.set(&#x27;views&#x27;) || process.cwd() + &#x27;&#x2F;views&#x27;;

  &#x2F;&#x2F; utilize &quot;view engine&quot; option
  if (viewEngine) parent.engine = viewEngine;

  &#x2F;&#x2F; render the partial
  try {
    var str = renderPartial(this, view, options, null, parent);
  } catch (err) {
    if (fn) {
      fn(err);
    } else {
      this.req.next(err);
    }
    return;
  }

  &#x2F;&#x2F; callback or transfer
  if (fn) {
    fn(null, str);
  } else {
    this.send(str);
  }
};

&#x2F;**
 * Render &#x60;view&#x60; with the given &#x60;options&#x60; and optional callback &#x60;fn&#x60;.
 * When a callback function is given a response will _not_ be made
 * automatically, however otherwise a response of _200_ and _text&#x2F;html_ is given.
 *
 * Options:
 *
 *  - &#x60;scope&#x60;     Template evaluation context (the value of &#x60;this&#x60;)
 *  - &#x60;debug&#x60;     Output debugging information
 *  - &#x60;status&#x60;    Response status code
 *
 * @param  {String} view
 * @param  {Object|Function} options or callback function
 * @param  {Function} fn
 * @api public
 *&#x2F;

res.render = function(view, opts, fn, parent, sub){
  &#x2F;&#x2F; support callback function as second arg
  if (&#x27;function&#x27; == typeof opts) {
    fn = opts, opts = null;
  }

  try {
    return this._render(view, opts, fn, parent, sub);
  } catch (err) {
    &#x2F;&#x2F; callback given
    if (fn) {
      fn(err);
    &#x2F;&#x2F; unwind to root call to prevent multiple callbacks
    } else if (sub) {
      throw err;
    &#x2F;&#x2F; root template, next(err)
    } else {
      this.req.next(err);
    }
  }
};

&#x2F;&#x2F; private render()

res._render = function(view, opts, fn, parent, sub){
  var options = {}
    , self = this
    , app = this.app
    , helpers = app._locals
    , dynamicHelpers = app.dynamicViewHelpers
    , viewOptions = app.set(&#x27;view options&#x27;)
    , root = app.set(&#x27;views&#x27;) || process.cwd() + &#x27;&#x2F;views&#x27;;

  &#x2F;&#x2F; cache id
  var cid = app.enabled(&#x27;view cache&#x27;)
    ? view + (parent ? &#x27;:&#x27; + parent.path : &#x27;&#x27;)
    : false;

  &#x2F;&#x2F; merge &quot;view options&quot;
  if (viewOptions) merge(options, viewOptions);

  &#x2F;&#x2F; merge res._locals
  if (this._locals) merge(options, this._locals);

  &#x2F;&#x2F; merge render() options
  if (opts) merge(options, opts);

  &#x2F;&#x2F; merge render() .locals
  if (opts &amp;&amp; opts.locals) merge(options, opts.locals);

  &#x2F;&#x2F; status support
  if (options.status) this.statusCode = options.status;

  &#x2F;&#x2F; capture attempts
  options.attempts = [];

  var partial = options.isPartial
    , layout = options.layout;

  &#x2F;&#x2F; Layout support
  if (true === layout || undefined === layout) {
    layout = &#x27;layout&#x27;;
  }

  &#x2F;&#x2F; Default execution scope to a plain object
  options.scope = options.scope || {};

  &#x2F;&#x2F; Populate view
  options.parentView = parent;

  &#x2F;&#x2F; &quot;views&quot; setting
  options.root = root;

  &#x2F;&#x2F; &quot;view engine&quot; setting
  options.defaultEngine = app.set(&#x27;view engine&#x27;);

  &#x2F;&#x2F; charset option
  if (options.charset) this.charset = options.charset;

  &#x2F;&#x2F; Dynamic helper support
  if (false !== options.dynamicHelpers) {
    &#x2F;&#x2F; cache
    if (!this.__dynamicHelpers) {
      this.__dynamicHelpers = {};
      for (var key in dynamicHelpers) {
        this.__dynamicHelpers[key] = dynamicHelpers[key].call(
            this.app
          , this.req
          , this);
      }
    }

    &#x2F;&#x2F; apply
    merge(options, this.__dynamicHelpers);
  }

  &#x2F;&#x2F; Merge view helpers
  union(options, helpers);

  &#x2F;&#x2F; Always expose partial() as a local
  options.partial = function(path, opts){
    return renderPartial(self, path, opts, options, view);
  };

  &#x2F;&#x2F; View lookup
  options.hint = app.enabled(&#x27;hints&#x27;);
  view = exports.compile(view, app.cache, cid, options);

  &#x2F;&#x2F; layout helper
  options.layout = function(path){
    layout = path;
  };

  &#x2F;&#x2F; render
  var str = view.fn.call(options.scope, options);

  &#x2F;&#x2F; layout expected
  if (layout) {
    options.isLayout = true;
    options.layout = false;
    options.body = str;
    this.render(layout, options, fn, view, true);
  &#x2F;&#x2F; partial return
  } else if (partial) {
    return str;
  &#x2F;&#x2F; render complete, and
  &#x2F;&#x2F; callback given
  } else if (fn) {
    fn(null, str);
  &#x2F;&#x2F; respond
  } else {
    this.send(str);
  }
}

&#x2F;**
 * Hint at view path resolution, outputting the
 * paths that Express has tried.
 *
 * @api private
 *&#x2F;

function hintAtViewPaths(view, options) {
  console.error();
  console.error(&#x27;failed to locate view &quot;&#x27; + view.view + &#x27;&quot;, tried:&#x27;);
  options.attempts.forEach(function(path){
    console.error(&#x27;  - %s&#x27;, path);
  });
  console.error();
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
