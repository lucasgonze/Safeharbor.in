<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Enables filtering in class lists..html">Enables filtering in class lists.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of currency amounts.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;
POSIX LC_MONETARY&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of dates and times.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;
POSIX LC_TIME&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;..html">Namespace container for the JsWorld library objects..Class for localised formatting of numbers.

&lt;p&gt;See: &lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;
POSIX LC_NUMERIC&lt;&#x2F;a&gt;.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings..html">Namespace container for the JsWorld library objects..Class for parsing localised currency amount strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised date and time strings..html">Namespace container for the JsWorld library objects..Class for parsing localised date and time strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Class for parsing localised number strings..html">Namespace container for the JsWorld library objects..Class for parsing localised number strings.</a></li>
            
                <li><a href="..&#x2F;classes/Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;.html">Namespace container for the JsWorld library objects..Represents a POSIX-style locale with its numeric, monetary and date&#x2F;time 
properties. Also provides a set of locale helper methods.

&lt;p&gt;The locale properties follow the POSIX standards:

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_04&quot;&gt;POSIX LC_NUMERIC&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;009695399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_03&quot;&gt;POSIX LC_MONETARY&lt;&#x2F;a&gt;
    &lt;li&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.opengroup.org&#x2F;onlinepubs&#x2F;000095399&#x2F;basedefs&#x2F;xbd_chap07.html#tag_07_03_05&quot;&gt;POSIX LC_TIME&lt;&#x2F;a&gt;
&lt;&#x2F;ul&gt;</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: node_modules&#x2F;express&#x2F;lib&#x2F;router&#x2F;index.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">

&#x2F;*!
 * Express - Router
 * Copyright(c) 2010 TJ Holowaychuk &lt;tj@vision-media.ca&gt;
 * MIT Licensed
 *&#x2F;

&#x2F;**
 * Module dependencies.
 *&#x2F;

var Route = require(&#x27;.&#x2F;route&#x27;)
  , Collection = require(&#x27;.&#x2F;collection&#x27;)
  , utils = require(&#x27;..&#x2F;utils&#x27;)
  , parse = require(&#x27;url&#x27;).parse
  , toArray = utils.toArray;

&#x2F;**
 * Expose &#x60;Router&#x60; constructor.
 *&#x2F;

exports = module.exports = Router;

&#x2F;**
 * Expose HTTP methods.
 *&#x2F;

var methods = exports.methods = require(&#x27;.&#x2F;methods&#x27;);

&#x2F;**
 * Initialize a new &#x60;Router&#x60; with the given &#x60;app&#x60;.
 * 
 * @param {express.HTTPServer} app
 * @api private
 *&#x2F;

function Router(app) {
  var self = this;
  this.app = app;
  this.routes = {};
  this.params = {};
  this._params = [];

  this.middleware = function(req, res, next){
    self._dispatch(req, res, next);
  };
}

&#x2F;**
 * Register a param callback &#x60;fn&#x60; for the given &#x60;name&#x60;.
 *
 * @param {String|Function} name
 * @param {Function} fn
 * @return {Router} for chaining
 * @api public
 *&#x2F;

Router.prototype.param = function(name, fn){
  &#x2F;&#x2F; param logic
  if (&#x27;function&#x27; == typeof name) {
    this._params.push(name);
    return;
  }

  &#x2F;&#x2F; apply param functions
  var params = this._params
    , len = params.length
    , ret;

  for (var i = 0; i &lt; len; ++i) {
    if (ret = params[i](name, fn)) {
      fn = ret;
    }
  }

  &#x2F;&#x2F; ensure we end up with a
  &#x2F;&#x2F; middleware function
  if (&#x27;function&#x27; != typeof fn) {
    throw new Error(&#x27;invalid param() call for &#x27; + name + &#x27;, got &#x27; + fn);
  }

  (this.params[name] = this.params[name] || []).push(fn);
  return this;
};

&#x2F;**
 * Return a &#x60;Collection&#x60; of all routes defined.
 *
 * @return {Collection}
 * @api public
 *&#x2F;

Router.prototype.all = function(){
  return this.find(function(){
    return true;
  });
};

&#x2F;**
 * Remove the given &#x60;route&#x60;, returns
 * a bool indicating if the route was present
 * or not.
 *
 * @param {Route} route
 * @return {Boolean}
 * @api public
 *&#x2F;

Router.prototype.remove = function(route){
  var routes = this.routes[route.method]
    , len = routes.length;

  for (var i = 0; i &lt; len; ++i) {
    if (route == routes[i]) {
      routes.splice(i, 1);
      return true;
    }
  }
};

&#x2F;**
 * Return routes with route paths matching &#x60;path&#x60;.
 *
 * @param {String} method
 * @param {String} path
 * @return {Collection}
 * @api public
 *&#x2F;

Router.prototype.lookup = function(method, path){
  return this.find(function(route){
    return path == route.path
      &amp;&amp; (route.method == method
      || method == &#x27;all&#x27;);
  });
};

&#x2F;**
 * Return routes with regexps that match the given &#x60;url&#x60;.
 *
 * @param {String} method
 * @param {String} url
 * @return {Collection}
 * @api public
 *&#x2F;

Router.prototype.match = function(method, url){
  return this.find(function(route){
    return route.match(url)
      &amp;&amp; (route.method == method
      || method == &#x27;all&#x27;);
  });
};

&#x2F;**
 * Find routes based on the return value of &#x60;fn&#x60;
 * which is invoked once per route.
 *
 * @param {Function} fn
 * @return {Collection}
 * @api public
 *&#x2F;

Router.prototype.find = function(fn){
  var len = methods.length
    , ret = new Collection(this)
    , method
    , routes
    , route;

  for (var i = 0; i &lt; len; ++i) {
    method = methods[i];
    routes = this.routes[method];
    if (!routes) continue;
    for (var j = 0, jlen = routes.length; j &lt; jlen; ++j) {
      route = routes[j];
      if (fn(route)) ret.push(route);
    }
  }

  return ret;
};

&#x2F;**
 * Route dispatcher aka the route &quot;middleware&quot;.
 *
 * @param {IncomingMessage} req
 * @param {ServerResponse} res
 * @param {Function} next
 * @api private
 *&#x2F;

Router.prototype._dispatch = function(req, res, next){
  var params = this.params
    , self = this;

  &#x2F;&#x2F; route dispatch
  (function pass(i, err){
    var paramCallbacks
      , paramIndex = 0
      , paramVal
      , route
      , keys
      , key
      , ret;

    &#x2F;&#x2F; match next route
    function nextRoute(err) {
      pass(req._route_index + 1, err);
    }

    &#x2F;&#x2F; match route
    req.route = route = self._match(req, i);

    &#x2F;&#x2F; implied OPTIONS
    if (!route &amp;&amp; &#x27;OPTIONS&#x27; == req.method) return self._options(req, res);

    &#x2F;&#x2F; no route
    if (!route) return next(err);

    &#x2F;&#x2F; we have a route
    &#x2F;&#x2F; start at param 0
    req.params = route.params;
    keys = route.keys;
    i = 0;

    &#x2F;&#x2F; param callbacks
    function param(err) {
      paramIndex = 0;
      key = keys[i++];
      paramVal = key &amp;&amp; req.params[key.name];
      paramCallbacks = key &amp;&amp; params[key.name];

      try {
        if (&#x27;route&#x27; == err) {
          nextRoute();
        } else if (err) {
          i = 0;
          callbacks(err);
        } else if (paramCallbacks &amp;&amp; undefined !== paramVal) {
          paramCallback();
        } else if (key) {
          param();
        } else {
          i = 0;
          callbacks();
        }
      } catch (err) {
        param(err);
      }
    };

    param(err);
    
    &#x2F;&#x2F; single param callbacks
    function paramCallback(err) {
      var fn = paramCallbacks[paramIndex++];
      if (err || !fn) return param(err);
      fn(req, res, paramCallback, paramVal, key.name);
    }

    &#x2F;&#x2F; invoke route callbacks
    function callbacks(err) {
      var fn = route.callbacks[i++];
      try {
        if (&#x27;route&#x27; == err) {
          nextRoute();
        } else if (err &amp;&amp; fn) {
          if (fn.length &lt; 4) return callbacks(err);
          fn(err, req, res, callbacks);
        } else if (fn) {
          fn(req, res, callbacks);
        } else {
          nextRoute(err);
        }
      } catch (err) {
        callbacks(err);
      }
    }
  })(0);
};

&#x2F;**
 * Respond to __OPTIONS__ method.
 *
 * @param {IncomingMessage} req
 * @param {ServerResponse} res
 * @api private
 *&#x2F;

Router.prototype._options = function(req, res){
  var path = parse(req.url).pathname
    , body = this._optionsFor(path).join(&#x27;,&#x27;);
  res.send(body, { Allow: body });
};

&#x2F;**
 * Return an array of HTTP verbs or &quot;options&quot; for &#x60;path&#x60;.
 *
 * @param {String} path
 * @return {Array}
 * @api private
 *&#x2F;

Router.prototype._optionsFor = function(path){
  var self = this;
  return methods.filter(function(method){
    var routes = self.routes[method];
    if (!routes || &#x27;options&#x27; == method) return;
    for (var i = 0, len = routes.length; i &lt; len; ++i) {
      if (routes[i].match(path)) return true;
    }
  }).map(function(method){
    return method.toUpperCase();
  });
};

&#x2F;**
 * Attempt to match a route for &#x60;req&#x60;
 * starting from offset &#x60;i&#x60;.
 *
 * @param {IncomingMessage} req
 * @param {Number} i
 * @return {Route}
 * @api private
 *&#x2F;

Router.prototype._match = function(req, i){
  var method = req.method.toLowerCase()
    , url = parse(req.url)
    , path = url.pathname
    , routes = this.routes
    , captures
    , route
    , keys;

  &#x2F;&#x2F; pass HEAD to GET routes
  if (&#x27;head&#x27; == method) method = &#x27;get&#x27;;

  &#x2F;&#x2F; routes for this method
  if (routes = routes[method]) {

    &#x2F;&#x2F; matching routes
    for (var len = routes.length; i &lt; len; ++i) {
      route = routes[i];
      if (captures = route.match(path)) {
        keys = route.keys;
        route.params = [];

        &#x2F;&#x2F; params from capture groups
        for (var j = 1, jlen = captures.length; j &lt; jlen; ++j) {
          var key = keys[j-1]
            , val = &#x27;string&#x27; == typeof captures[j]
              ? decodeURIComponent(captures[j])
              : captures[j];
          if (key) {
            route.params[key.name] = val;
          } else {
            route.params.push(val);
          }
        }

        &#x2F;&#x2F; all done
        req._route_index = i;
        return route;
      }
    }
  }
};

&#x2F;**
 * Route &#x60;method&#x60;, &#x60;path&#x60;, and one or more callbacks.
 *
 * @param {String} method
 * @param {String} path
 * @param {Function} callback...
 * @return {Router} for chaining
 * @api private
 *&#x2F;

Router.prototype._route = function(method, path, callbacks){
  var app = this.app
    , callbacks = utils.flatten(toArray(arguments, 2));

  &#x2F;&#x2F; ensure path was given
  if (!path) throw new Error(&#x27;app.&#x27; + method + &#x27;() requires a path&#x27;);

  &#x2F;&#x2F; create the route
  var route = new Route(method, path, callbacks, {
      sensitive: app.enabled(&#x27;case sensitive routes&#x27;)
    , strict: app.enabled(&#x27;strict routing&#x27;)
  });

  &#x2F;&#x2F; add it
  (this.routes[method] = this.routes[method] || [])
    .push(route);
  return this;
};

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
